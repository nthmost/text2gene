<html>
<head>
    <title>Text2Gene HgvsQuery</title>
    <style>
            #left {
                width: 480px;
                float: left;
            }

            #right {
                margin-top: 40px;
                margin-left: 500px;
                padding-bottom: 20px;
            }

            .ncbi_tag {
                color: darkolivegreen;
            }

            .error {
                color: red;
            }

            .clear {
                clear: both;
            }

            .positive {
                background-color: lightblue;
            }

            .negative {
                background-color: whitesmoke;
            }

            #pubmed_sources {
                padding: 5px;
                margin: 5px;
            }
            #pubmed_sources tr td {
                padding: 5px;
                text-align: center;
            }
            #pubmed_sources tr td img {
                width: 25px;
            }
            td.pmid {
                font-weight: bold;
            }
            td.pmid a {
                text-decoration: none;
            }
            td.pmid a:hover {
                text-decoration: underline;
            }
            button {
                font-weight: bold;
                color: green;
            }
            .mention {
                background-color: lightpink;
                padding: 5px;
            }
            .mention a {
                text-decoration: none;
            }
            .mention a:hover {
                text-decoration: dotted;
            }
            .citation {
                width: 350px;
            }
            .green_dot {
                width: 50px;
            }
            .pubtator {
                width: 80px;
            }
            .google {
                width: 350px;
            }
            .snippet a {
                text-decoration: none;
            }
            .snippet a:hover {
                text-decoration: underline;
            }
    </style>
</head>

<body>

<div class="clear">

    <h1>{{ lex.hgvs_text|e }}</h1>
    <div class="left">
    <h4>Gene: {% if gene %}{{ gene.gene_name }}
        <a href="{{ gene.gtr_url }}" target="_blank"><button>GTR</button></a>
        <a href="{{ gene.medgen_url }}" target="_blank"><button>MedGen</button></a>
        <a href="{{ gene.pubmed_clinical_query_url }}" target="_blank"><button>Clinical Query</button></a>
        {% else %}(unknown){% endif %}</h4>

    <h4>Variant in ClinVar: {% if clinvar.url %}<a target="_blank" href="{{ clinvar.url }}"><button>{{ clinvar.variationID }}</button></a>
                                   {% else %}(unknown){% endif %}</h4>

    </div>

    {% if lovd_url %}<a target="_blank" href="{{ lovd_url }}"><button>LOVD Search</button></a>{% endif %}

    </div>

</div>
<div class="clear">
<span class="error"><ul>{% for error in citation_table.errors %}<li>{{ error }}</li>{% endfor %}</ul></span>

<hr />
    <h3>Pubmed Sources</h3>
    <table id="pubmed_sources">
        <tr><th>PMID</th><th>Citation</th><th>ClinVar</th><th>NCBI</th><th>Abstract Mentions</th><th>Google</th><th>PDF</th></tr>
        {% for citation in citation_table.citations %}
        <tr class="{{ loop.cycle('positive', 'negative') }}">
            <td class="pmid"><a target="_blank" href="{{ citation.pubmed_url }}">{{ citation.pmid }}</a></td>
            <td class="citation">{{ citation.citation }}</td>
            <td class="green_dot">{% if citation.in_clinvar %}<a target="_blank" href="{{ citation.clinvar_url }}"><img src="/greenlight.png" /></a>{% endif %}</td>
            <td class="green_dot">{% if citation.in_ncbi %}<img src="/greenlight.png" />{% endif %}</td>
            <td class="pubtator">{% if citation.in_pubtator %}<span class="mention"><a target="_blank" href="{{ citation.pubtator_url }}">{{ citation.pubtator_mention }}</a></span>{% endif %}</td>
            <td class="google">{% if citation.in_google %}<span class="snippet"><a target="_blank" href="{{ citation.google_url }}">{{ citation.htmlSnippet }}</a></span>{% endif %}</td>
            <td class="pdf">{% if citation.pdf_url %}<a href="{{ citation.pdf_url }}">[pdf]</a>{% endif %}</td>
        </tr>{% endfor %}
    </table>

</div>

    <hr />

<div class="clear">
    <h3>LVG Output</h3>
    <ul>
    {% for seqtype, hgvs_list in lex.variants.iteritems() %}
    {% if hgvs_list %}{% for hgvs_text in hgvs_list %}
        {% if hgvs_text.startswith('NM_') or hgvs_text.startswith('NC_') or hgvs_text.startswith('NP_') %}
        <li><a href="/query/{{ hgvs_text }}">{{ hgvs_text }}</a>  {% if hgvs_text in ncbi_variants %}<span class="ncbi_tag">[NCBI]</span>{% endif %}</li>
        {% else %}
        <li>{{ hgvs_text }}  {% if hgvs_text in ncbi_variants %}<span class="ncbi_tag">[NCBI]</span>{% endif %}</li>
        {% endif %}
        {% endfor %}{% endif %}
    {% endfor %}
    </ul>
</div>


<div class="clear">
    <hr />
    <h3>Google Query Expansion</h3>
    <p>{% if citation_table.google_query %}{{ citation_table.google_query|e }}
    <ul>
        <li>c.: <a target="_blank" href='/v1/google/{{ lex.hgvs_text }}?seqtypes=c'>{{ citation_table.google_query_c }}</a></li>
        <li>p.: <a target="_blank" href='/v1/google/{{ lex.hgvs_text }}?seqtypes=p'>{{ citation_table.google_query_p }}</a></li>
        <li>g.: <a target="_blank" href='/v1/google/{{ lex.hgvs_text }}?seqtypes=g'>{{ citation_table.google_query_g }}</a></li>
        <li>n.: <a target="_blank" href='/v1/google/{{ lex.hgvs_text }}?seqtypes=n'>{{ citation_table.google_query_n }}</a></li>
    </ul>

    {% else %}(Cannot build without gene name){% endif %}</p>

    {% if found_in_clinvar_example_tables %}
    <hr /><h3>Found in Clinvar hgvs sample tables:</h3>
    <ul>{% for tname in found_in_clinvar_example_tables %}
    <li>{{ tname }}</li>
    {% endfor %}
    </ul>
    {% endif %}

</div>

</body>
</html>
